<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Contributing to {gitlabr} • gitlabr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css"><script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet"><script src="pkgdown.js"></script><meta property="og:title" content="Contributing to {gitlabr}"><meta property="og:image" content="https://thinkr-open.github.io/gitlabr/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-title-body">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">gitlabr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.1.9010</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="articles/a-quick-start-guide-to-gitlabr.html">Quick Start Guide to 'gitlabr'</a>
    </li>
    <li>
      <a href="articles/b-projects.html">Create and manage a new GitLab project</a>
    </li>
    <li>
      <a href="articles/c-alternative-connection-to-projects.html">Alternative connections to projects</a>
    </li>
    <li>
      <a href="articles/d-go-further-understand-and-build.html">Go further: understand and build your functions</a>
    </li>
    <li>
      <a href="articles/e-create-gitlab-ci-pipelines.html">e-create-gitlab-ci-pipelines</a>
    </li>
    <li>
      <a href="articles/z-gitlabr-v2.html">Breaking changes in 'gitlabr' V2</a>
    </li>
  </ul></li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ThinkR-open/gitlabr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>Contributing to {gitlabr}</h1>
    </div>

<div id="contributing-to-gitlabr" class="section level1">

<p>You’re welcome to contribute to {gitlabr} by editing the source code, adding more convenience functions, filing issues, etc. This document compiles some information helpful in that process.</p>
<p>Please also note the <a href="CONDUCT.html">Code of Conduct</a>.</p>
<div class="section level2">
<h2 id="setup-a-development-environment">Setup a development environment<a class="anchor" aria-label="anchor" href="#setup-a-development-environment"></a></h2>
<p>The {gitlabr} test suite expects certain entities (user, project, files, comments) to be present in the test server. Below are the guidelines to setup a GitLab instance and the local file <code>dev/environment.yml</code>. Note that <a href="https://gitlab.com/statnmap/testor.main" class="external-link uri">https://gitlab.com/statnmap/testor.main</a> was created following these guidelines.</p>
<ol style="list-style-type: decimal"><li><p>Install &amp; make GitLab instance reachable at a certain address. The easiest ways are to use either a Docker image of the GitLab version of interest or directly use <a href="https://gitlab.com" class="external-link uri">https://gitlab.com</a>.</p></li>
<li><p>Create a file named <code>environment.yml</code> and save it in the <code>dev/</code> directory of your clone of {gitlabr}.</p></li>
</ol><ul><li>See <code>environment.yml.example</code> as the template to fill as follows</li>
</ul><ol start="3" style="list-style-type: decimal"><li>Create a user on your GitLab instance</li>
</ol><ul><li>Add your username in <code>environment.yml</code> as <code>GITLABR_TEST_LOGIN</code>
</li>
<li>Add your user ID in <code>environment.yml</code> as <code>GITLABR_TEST_LOGIN_ID</code> (numeric)
<ul><li>Go to your profile (e.g. <a href="https://gitlab.com/profile" class="external-link uri">https://gitlab.com/profile</a>) and look up for your User ID</li>
</ul></li>
<li>Add your user password in <code>environment.yml</code> as <code>GITLABR_TEST_PASSWORD</code>
</li>
</ul><ol start="4" style="list-style-type: decimal"><li>Generate a private access token for the user that grants all read/write access to the API</li>
</ol><ul><li>For instance on gitlab.com: <a href="https://gitlab.com/profile/personal_access_tokens" class="external-link uri">https://gitlab.com/profile/personal_access_tokens</a>
</li>
<li>Tick the fist checkboxes (the <code>api</code> scope)</li>
<li>Add the token in the <code>environment.yml</code> or environment variables as “GITLABR_TEST_TOKEN”</li>
</ul><p><strong>=&gt; From now on, you can use “dev/create_testor_on_gitlab.R” script to automate required repository content for steps 5 - 11.</strong></p>
<ol start="5" style="list-style-type: decimal"><li>Create a project called <code>testor</code>, owned by the user, and containing a <code>README.md</code> file</li>
</ol><ul><li>New Project &gt; Initialize with a README</li>
<li>be sure that the main branch is called <code>main</code>
</li>
<li>Add the project name in the <code>environment.yml</code> as variable named “GITLABR_TEST_PROJECT_NAME”</li>
</ul><ol start="6" style="list-style-type: decimal"><li>Get the ID of the project and add it in <code>environment.yml</code> as variable named “GITLABR_TEST_PROJECT_ID”</li>
</ol><ul><li>Project Overview &gt; Details</li>
<li>The Project ID is under the name of your project</li>
</ul><ol start="7" style="list-style-type: decimal"><li>Add/modify and commit the <code>README.md</code>:</li>
</ol><div class="sourceCode" id="cb1"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu"># testor</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>Repository to test R package <span class="co">[</span><span class="ot">{gitlabr}</span><span class="co">](https://github.com/ThinkR-open/gitlabr)</span></span></code></pre></div>
<ol start="8" style="list-style-type: decimal"><li><p>Go to Repository &gt; Branches and create a branch named “for-tests”.</p></li>
<li><p>Add and commit a CI file (<code>.gitlab-ci.yml</code>) in the main/master branch that includes a job named <code>testing</code> that should minimally create <code>public/test.txt</code> as an artifact, we recommend using the following <code>.gitlab-ci.yml</code> file:</p></li>
</ol><div class="sourceCode" id="cb2"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">testing</span><span class="kw">:</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="at">  </span><span class="fu">script</span><span class="kw">:</span><span class="at"> echo 'test 1 2 1 2' &gt; 'test.txt'</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="at">  </span><span class="fu">artifacts</span><span class="kw">:</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="at">    </span><span class="fu">paths</span><span class="kw">:</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> test.txt</span></span></code></pre></div>
<ol start="10" style="list-style-type: decimal"><li>Create a commit (or use the commit just created), add a follow-up comment and add its 40-character SHA-1 hash in the <code>environment.yml</code> as variable named ‘COMMENTED_COMMIT’, to do so:</li>
</ol><ul><li>Go to Repository &gt; Commits</li>
<li>Copy the <sha1> of the relevant commit</sha1></li>
<li>Click on the relevant commit</li>
<li>Write a comment</li>
<li>Add its <sha1> in ‘COMMENTED_COMMIT’ in <code>environment.yml</code></sha1></li>
</ul><ol start="11" style="list-style-type: decimal"><li>Create a first issue (#1) with a follow-up comment</li>
</ol><ul><li>Go to Issues &gt; List &gt; New issue</li>
<li>Add a title and a description for the issue then click on <code>Submit issue</code>
</li>
<li>Then add a follow-up comment to this issue</li>
</ul><div class="section level3">
<h3 id="how-to-run-the-test-suite">How to run the test suite<a class="anchor" aria-label="anchor" href="#how-to-run-the-test-suite"></a></h3>
<p>When the test server is set up as described above, tests can be run with the following R code that loads the recorded environment variables and runs the test code:</p>
<p><code>{r} devtools::load_all() do.call(Sys.setenv, yaml::yaml.load_file("dev/environment.yml")) ## load test environment variables devtools::test() ## run all tests testthat::test_file("tests/testthat/test_ci.R") ## run test on one file</code></p>
<p><em>Note that if the test suite fails, you may leave the repository in a state that is not cleaned.</em> <em>Hence, you may have to manually clean the repository on GitLab before running the tests again.</em></p>
</div>
<div class="section level3">
<h3 id="how-to-check-the-package-with-github-actions-on-your-own-fork">How to check the package with GitHub Actions on your own fork<a class="anchor" aria-label="anchor" href="#how-to-check-the-package-with-github-actions-on-your-own-fork"></a></h3>
<p>For GitHub users, it is possible to directly use <a href="https://docs.github.com/en/free-pro-team@latest/actions/reference/workflow-syntax-for-github-actions" class="external-link">GitHub Actions</a> to test whether the package can be build smoothly before creating a PR. To do so, they should add the following environmental variables (the ones listed in <code>environment.yml</code>) as <a href="https://docs.github.com/en/free-pro-team@latest/actions/reference/encrypted-secrets" class="external-link">encrypted secrets</a>,</p>
<ul><li>GITLABR_TEST_LOGIN</li>
<li>GITLABR_TEST_LOGIN_ID</li>
<li>GITLABR_TEST_PASSWORD</li>
<li>GITLABR_TEST_TOKEN</li>
<li>GITLABR_TEST_URL</li>
</ul><p>Also, another encrypted secrets named <code>REPO_GHA_PAT</code> is required, it should include a <a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/creating-a-personal-access-token" class="external-link">personal access token</a> that has access to your GitHub repositories.</p>
<p>Note that the current GitHub Actions use different projects to test OS separately, in parallel. This means the following environmental variables will not work with your fork:</p>
<ul><li>GITLABR_TEST_PROJECT_ID</li>
<li>GITLABR_TEST_PROJECT_NAME</li>
<li>COMMENTED_COMMIT</li>
</ul><p>This value are directly set in the core of the action. If you really want to run GitHub Actions on your own fork before opening a PR, you can run “dev/create_testor_on_gitlab.R” to create the different CI repositories and modify the matrix of configuration in the corresponding CI configuration file.<br>
However, you will need to put back original values to open a PR.</p>
<!--
You may need to temporarily modify the Actions OS matrix to fit your needs. 
I recommend to keep only one OS tested to avoid unit tests to be run in parallel on the same repository.
To do so, you can comment all but one OS in ".github/workflows/R-CMD-check.yaml", and change the values of the variable according to your configuration.
-->
<p><em>Note that if the test suite fails, you may leave the repository in a state that is not cleaned.</em> <em>Hence, you may have to manually clean the repository on GitLab before running the tests again.</em></p>
</div>
<div class="section level3">
<h3 id="api-version">API version<a class="anchor" aria-label="anchor" href="#api-version"></a></h3>
<p>The test suite is intended for use with GitLab API v4, compatibility with API v3 is no longer maintained. Still, you can switch to run the tests against API v3, by setting the environment variable <code>GITLABR_TEST_API_VERSION</code> to value <code>3</code>. Note that API v3 is not present in recent GitLab versions!</p>
</div>
<div class="section level3">
<h3 id="api-limitation">API limitation<a class="anchor" aria-label="anchor" href="#api-limitation"></a></h3>
<p>Note that GitLab.com has some limitations : <a href="https://docs.gitlab.com/ee/user/gitlab_com/index.html#gitlabcom-specific-rate-limits" class="external-link uri">https://docs.gitlab.com/ee/user/gitlab_com/index.html#gitlabcom-specific-rate-limits</a> Authenticated API traffic (for a given user) [From 2021-02-12]: 2,000 requests per minute</p>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>

</div>



      <footer><div class="copyright">
  <p></p><p>Developed by Jirka Lewandowski, Sébastien Rochette.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

