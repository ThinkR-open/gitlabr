<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Contributing to {gitlabr} • gitlabr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script>




<meta property="og:title" content="Contributing to {gitlabr}" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-title-body">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">gitlabr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.6.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="articles/quick-start-guide-to-gitlabr.html">Quick Start Guide to {gitlabr}</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statnmap/gitlabr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>Contributing to {gitlabr}</h1>
    </div>

<div id="contributing-to-gitlabr" class="section level1">

<p>You’re welcome to contribute to {gitlabr} by editing the source code, adding more convenience functions, filing issues, etc. This document compiles some information helpful in that process.</p>
<p>Please also note the <a href="CONDUCT.html">Code of Conduct</a>.</p>
<div id="setup-a-development-environment" class="section level2">
<h2 class="hasAnchor">
<a href="#setup-a-development-environment" class="anchor"></a>Setup a development environment</h2>
<p>The {gitlabr} test suite expects certain entities (user, project, files, comments) to be present in the test server. Below are the guidelines to setup a GitLab instance and the local file <code>tests/environment.yml</code>. Note that <a href="https://gitlab.com/KevCaz/testor" class="uri">https://gitlab.com/KevCaz/testor</a> was created following these guidelines.</p>
<ol>
<li><p>Install &amp; make GitLab instance reachable at a certain address. The easiest ways are to use either a Docker image of the GitLab version of interest or directly use <a href="https://gitlab.com" class="uri">https://gitlab.com</a>.</p></li>
<li><p>Create a file named <code>environment.yml</code> and save it in the <code>tests/</code> directory of your clone of {gitlabr}.</p></li>
</ol>
<ul>
<li>See <code>environment.yml.example</code> as the template to fill as follows</li>
</ul>
<ol>
<li>Create a user on your GitLab instance</li>
</ol>
<ul>
<li>Add your username in <code>environment.yml</code> as <code>GITLABR_TEST_LOGIN</code>
</li>
<li>Add your user ID in <code>environment.yml</code> as <code>GITLABR_TEST_LOGIN_ID</code> (numeric)
<ul>
<li>Go to your profile (e.g. <a href="https://gitlab.com/profile" class="uri">https://gitlab.com/profile</a>) and look up for your User ID</li>
</ul>
</li>
<li>Add your user password in <code>environment.yml</code> as <code>GITLABR_TEST_PASSWORD</code>
</li>
</ul>
<ol>
<li>Generate a private access token for the user that grants all read/write access to the API</li>
</ol>
<ul>
<li>For instance on gitlab.com: <a href="https://gitlab.com/profile/personal_access_tokens" class="uri">https://gitlab.com/profile/personal_access_tokens</a>
</li>
<li>Tick the fist checkboxes (the <code>api</code> scope)</li>
<li>Add the token in the <code>environment.yml</code> or environment variables as “GITLABR_TEST_TOKEN”</li>
</ul>
<ol>
<li>Create a project called <code>testor</code>, owned by the user, and containing a <code>README.md</code> file</li>
</ol>
<ul>
<li>New Project &gt; Initialize with a README</li>
<li>Add this name in the <code>environment.yml</code> as variable named “GITLABR_TEST_PROJECT_NAME”</li>
</ul>
<ol>
<li>Get the ID of the project and add it in <code>environment.yml</code> as variable named “GITLABR_TEST_PROJECT_ID”</li>
</ol>
<ul>
<li>Project Overview &gt; Details</li>
<li>The Project ID is under the name of your project</li>
</ul>
<ol>
<li>Add and commit a CI file (<code>.gitlab-ci.yml</code>) that includes a job named <code>testing</code> that should minimally create <code>public/coverage.html</code> as an artifact, we recommend using the following <code>.gitlab-ci.yml</code> file:</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">image</span><span class="kw">:</span><span class="at"> rocker/tidyverse</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">stages</span><span class="kw">:</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="at">  </span><span class="kw">-</span><span class="at"> build</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="at">  </span><span class="kw">-</span><span class="at"> test</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="at">  </span><span class="kw">-</span><span class="at"> deploy</span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">building</span><span class="kw">:</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="at">  </span><span class="fu">stage</span><span class="kw">:</span><span class="at"> build</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="at">  </span><span class="fu">script</span><span class="kw">:</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="at">    </span><span class="kw">-</span><span class="at"> R -e "remotes::install_deps(dependencies = TRUE)"</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="at">    </span><span class="kw">-</span><span class="at"> R -e 'devtools::check()'</span></span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="fu">testing</span><span class="kw">:</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="at">    </span><span class="fu">stage</span><span class="kw">:</span><span class="at"> test</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="at">    </span><span class="fu">allow_failure</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="at">    </span><span class="fu">when</span><span class="kw">:</span><span class="at"> on_success</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="at">    </span><span class="fu">only</span><span class="kw">:</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="at">        </span><span class="kw">-</span><span class="at"> master</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="at">    </span><span class="fu">script</span><span class="kw">:</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Rscript -e 'install.packages("DT")'</span></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="at">        </span><span class="kw">-</span><span class="at"> Rscript -e 'covr::gitlab(quiet = FALSE)'</span></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="at">    </span><span class="fu">artifacts</span><span class="kw">:</span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="at">        </span><span class="fu">paths</span><span class="kw">:</span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="at">            </span><span class="kw">-</span><span class="at"> public</span></span>
<span id="cb1-26"><a href="#cb1-26"></a></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="fu">pages</span><span class="kw">:</span></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="at">    </span><span class="fu">stage</span><span class="kw">:</span><span class="at"> deploy</span></span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="at">    </span><span class="fu">dependencies</span><span class="kw">:</span></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="at">        </span><span class="kw">-</span><span class="at"> testing</span></span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="at">    </span><span class="fu">script</span><span class="kw">:</span></span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="at">        </span><span class="kw">-</span><span class="at"> ls</span></span>
<span id="cb1-33"><a href="#cb1-33"></a><span class="at">    </span><span class="fu">artifacts</span><span class="kw">:</span></span>
<span id="cb1-34"><a href="#cb1-34"></a><span class="at">        </span><span class="fu">paths</span><span class="kw">:</span></span>
<span id="cb1-35"><a href="#cb1-35"></a><span class="at">            </span><span class="kw">-</span><span class="at"> public</span></span>
<span id="cb1-36"><a href="#cb1-36"></a><span class="at">        </span><span class="fu">expire_in</span><span class="kw">:</span><span class="at"> 30 days</span></span>
<span id="cb1-37"><a href="#cb1-37"></a><span class="at">    </span><span class="fu">only</span><span class="kw">:</span></span>
<span id="cb1-38"><a href="#cb1-38"></a><span class="at">        </span><span class="kw">-</span><span class="at"> master</span></span></code></pre></div>
<ol>
<li>Create a commit (or use the commit just created), add a follow-up comment and add its 40-character SHA-1 hash in the <code>environment.yml</code> as variable named ‘COMMENTED_COMMIT’, to do so:</li>
</ol>
<ul>
<li>Go to Repository &gt; Commits</li>
<li>Copy the <sha1> of the relevant commit</sha1>
</li>
<li>Click on the relevant commit</li>
<li>Write a comment</li>
</ul>
<ol>
<li>Create a first issue (#1) with a follow-up comment</li>
</ol>
<ul>
<li>Go to Issues &gt; List &gt; New issue</li>
<li>Add a title and a description for the issue then click on <code>Submit issue</code>
</li>
<li>Then add a follow-up comment to this issue</li>
</ul>
<ol>
<li>Go to Repository &gt; Branches and create a branch named “for-tests”.</li>
</ol>
<div id="how-to-run-the-test-suite" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-run-the-test-suite" class="anchor"></a>How to run the test suite</h3>
<p>When the test server is set up as described above, tests can be run with the following R code that loads the recorded environment variables and runs the test code:</p>
<pre class="{r}"><code><a href="https://devtools.r-lib.org/">library(devtools)
library(yaml)
do.call(Sys.setenv, yaml.load_file("tests/environment.yml")) ## load test environment variables
test() ## run tests</a></code></pre>
</div>
<div id="how-to-check-the-package-with-github-actions-on-your-own-fork" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-check-the-package-with-github-actions-on-your-own-fork" class="anchor"></a>How to check the package with GitHub Actions on your own fork</h3>
<p>For GitHub users, it is possible to directly use <a href="https://docs.github.com/en/free-pro-team@latest/actions/reference/workflow-syntax-for-github-actions">GitHub Actions</a> to test whether the package can be build smoothly before creating a PR. To do so, they should add the following environmental variables (the ones listed in <code>environment.yml</code>) as <a href="https://docs.github.com/en/free-pro-team@latest/actions/reference/encrypted-secrets">encrypted secrets</a>,</p>
<ul>
<li>COMMENTED_COMMIT</li>
<li>GITLABR_TEST_LOGIN</li>
<li>GITLABR_TEST_LOGIN_ID</li>
<li>GITLABR_TEST_PASSWORD</li>
<li>GITLABR_TEST_PROJECT_ID</li>
<li>GITLABR_TEST_PROJECT_NAME</li>
<li>GITLABR_TEST_TOKEN</li>
<li>GITLABR_TEST_URL</li>
</ul>
<p>Also, another encrypted secrets named <code>REPO_GHA_PAT</code> is required, it should include a <a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/creating-a-personal-access-token">personal access token</a> that has access to your GitHub repositories.</p>
</div>
<div id="api-version" class="section level3">
<h3 class="hasAnchor">
<a href="#api-version" class="anchor"></a>API version</h3>
<p>The test suite is intended for use with GitLab API v4, compatibility with API v3 is no longer maintained. Still, you can switch to run the tests against API v3, by setting the environment variable <code>GITLABR_TEST_API_VERSION</code> to value <code>3</code>. Note that API v3 is not present in recent GitLab versions!</p>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>

</div>



      <footer>
      <div class="copyright">
  <p>Developed by Jirka Lewandowski, Sébastien Rochette.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


